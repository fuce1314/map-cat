/**/ï»¿_jsload&&_jsload('hotspot', 'function B(e){this._map=e;this._enableSpot=true;this.bindMapEvent()}B.prototype.enable=function(){this._enableSpot=true};B.prototype.disable=function(){this._enableSpot=false};B.prototype.bindMapEvent=function(){var jg=this._map;var je=this;function i(){je.disable()}function e(){je.enable()}jg.addEventListener("movestart",i);jg.addEventListener("moveend",e);jg.addEventListener("zoomstart",i);jg.addEventListener("zoomend",function(){setTimeout(e,10)});function T(){je.reset()}jg.addEventListener("load",T);jg.addEventListener("moveend",T);jg.addEventListener("zoomend",T);jg.addEventListener("dragend",function(){this.temp.__dragged=true});jg.addEventListener("mousemove",function jf(jq){if(jg.currentOperation!==dL.idle||je._enableSpot===false){return}if(jq.overlay&&!(jq.overlay instanceof hL)||jq.infoWindow){return}var jv=this.temp;if(jv.spottimer){clearTimeout(jv.spottimer);jv.spottimer=null}if(jg.spotsPool){var jh=jg.temp.curSpots.slice(0);jg.temp.curSpots=[];var jr=je.getSpotsByScreenPosition(jq.pixel);if(jr.length>0){jg.platform.style.cursor="pointer"}jg.temp.curSpotsArray=[];for(var jo=jg.temp.curSpots.length-1;jo>=0;jo--){if(jg.temp.curSpots[jo]&&jg.temp.curSpots[jo].spots&&jg.temp.curSpots[jo].spots.length>0){jg.temp.curSpotsArray=jg.temp.curSpots[jo].spots;break}}var js=jg.temp.curSpotsArray.slice(0);var jj=[];var ju=jo;for(var jo=jh.length-1;jo>=0;jo--){if(jo===ju){jj=jh[ju]&&jh[ju].spots||[];for(var jn=0,jl=jj.length;jn<jl;jn++){for(var jm=0,ji=0,jk=jg.temp.curSpotsArray.length;jm<jk;jm++,ji++){if(jj[jn]===jg.temp.curSpotsArray[jm]){jj.splice(jn,1);jn--;js.splice(ji,1);ji--}}}}else{if(jh[jo]&&jh[jo].spots&&jh[jo].spots.length>0){for(var jn=0;jn<jh[jo].spots.length;jn++){jj.push(jh[jo].spots[jn])}}}}if(jj.length>0){var jp=new fa("onspotmouseout");jp.spots=jj.slice(0);jg.dispatchEvent(jp)}if(jg.temp.curSpotsArray.length===0){var jt=null;if(jg.getZoom()>=17){jt=je.checkAreaSpot(jq.point)}if(jt){if(jg.platform.style.cursor!=="pointer"){jg.platform.style.cursor="pointer"}jg.temp.curAreaSpot=jt}else{if(jg.platform.style.cursor!==jg.config.defaultCursor){jg.platform.style.cursor=jg.config.defaultCursor}jg.temp.curAreaSpot=null}}else{if(js.length>0){var jp=new fa("onspotmouseover");if(jg.temp.curSpots[jg.temp.curSpots.length-1].enableMultiResponse){jp.spots=js.slice(0)}else{js.sort(function(jx,jw){return jx._distance-jw._distance});jp.spots=js.slice(0,1)}if(jq.point){jp.point=new cf(jq.point.lng,jq.point.lat)}jp.pixel=new eO(jq.pixel.x,jq.pixel.y);jg.dispatchEvent(jp)}}}});jg.addEventListener("click",function(jn){var jl=this.temp;if(jn.overlay&&!(jn.overlay instanceof gB)){return}if(!jn.point){return}if(ev.Platform.iphone||ev.Platform.ipad||ev.Platform.android){jl.curSpotsArray=je.getSpotsByScreenPosition(jn.pixel)}var jm=new fa("onspotclick");jm.point=new cf(jn.point.lng,jn.point.lat);jm.pixel=new eO(jn.pixel.x,jn.pixel.y);if(jl.curSpotsArray.length>0){for(var jk=0,jh=jl.curSpots.length;jk<jh;jk++){if(jl.curSpots[jk].spots&&jl.curSpots[jk].spots.length>0){if(jl.curSpots[jk].enableMultiResponse){jm.spots=jl.curSpotsArray.slice(0)}else{jl.curSpotsArray.sort(function(jq,jp){return jq._distance-jp._distance});jm.spots=jl.curSpotsArray.slice(0,1)}break}}}var jj=jm.spots||[];for(var jk=0;jk<jj.length;jk++){var ji=jj[jk].pt;var jo=je.checkAreaSpot(ji);if(jo){jl.curAreaSpot=jo}}jm.curAreaSpot=jl.curAreaSpot;this.dispatchEvent(jm)});jg.addEventListener("rightclick",function(ji){if(ji.overlay&&!(ji.overlay instanceof gB)){return}if(!ji.point){return}var jh=new fa("onhotspotrightclick");jh.point=new cf(ji.latlng.lng,ji.latlng.lat);jh.mct=new cf(ji.point.lng,ji.point.lat);jh.pixel=new eO(ji.pixel.x,ji.pixel.y);if(t.environment==="customEditor"){jh.styleIds=je.checkStyleAreaSpot(ji.point)}this.dispatchEvent(jh)})};B.prototype.getSpotsByScreenPosition=function(jg){var jn=[];var e=this._map;var ji=e.getTilt();if(!e.spotsPool){return jn}for(var je in e.spotsPool){var jl=e.spotsPool[je];var jj=jl.spots.slice(0);if(jj[0]&&jj[0].userdata&&jj[0].userdata.mapPoi&&e._displayOptions.poi===false){continue}e.temp.curSpots[jl.zIndex]={spots:[],enableMultiResponse:jl.enableMultiResponse};for(var jh=0,jf=jj.length;jh<jf;jh++){var jm=jj[jh];if(jm.lr&&(e.getZoom()<jm.lr[0]||e.getZoom()>jm.lr[1])){continue}var T=jm.px||e.pointToPixelIn(jm.pt);if(T.x<e.width&&T.y<e.height){if((jg.x-T.x<jm.bd[2]&&jg.x-T.x>jm.bd[0])&&(T.y-jg.y<jm.bd[3]&&T.y-jg.y>jm.bd[1])){if(ji>55){var jk=e.pointToOverlayPixelIn(jm.pt);if(jk.outOfFrustum){continue}}e.temp.curSpots[jl.zIndex].spots.push(jm);jm._distance=b2(T,jg);jn.push(jm)}}}}return jn};B.prototype.checkAreaSpot=function(e){if(!e){return null}var T=this._map;if(T._displayOptions.indoor===false){return null}for(var je in T.areaSpots){var i=T.areaSpots[je];if(bC([e.lng,e.lat],i.spot)){return je}}return null};B.prototype.checkStyleAreaSpot=function(T){if(!T){return null}var jf=this._map;var i=[];for(var jg in jf.areaSpots){var je=jf.areaSpots[jg];var e=je.userData;if(e.type==="mapstyle"&&bC([T.lng,T.lat],je.spot)){i.push([e.styleId])}}return i};B.prototype.reset=function(){var e=this._map;if(e.temp.__dragged==true){e.temp.__dragged=false}else{e.temp.curSpots=[];e.platform.style.cursor=e.config.defaultCursor}};B.prototype.resetAreaSpot=function(){for(var T in this.areaSpots){var i=this.areaSpots[T];var e=i.userData;if(e.type==="mapstyle"){delete this.areaSpots[T]}}};bp.register(function(e){e._spotsMgr=new B(e)});');
