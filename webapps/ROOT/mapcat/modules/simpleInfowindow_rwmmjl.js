/**/ï»¿_jsload&&_jsload('simpleInfowindow', '(function(i){var jf=i.Utils;var T=jf.format;var e={prefix:"BMap_simple_bubble",windowOffset:[0,0],contentStyle:"display:block",centerStyle:"z-index:3;position:relative;",popStyle:"position:absolute;display:none;cursor:default;;background-color:#fff",bottomStyle:"display:block;z-index:2;position:absolute;width:16px;",tailShadowUrl:w.imgPath+"tail_shadow.png",tailShadowUrlSrcset:w.imgPath+"tail_shadow2x.png 2x",tailShadowStyle:"width:16px;height:10px;position:absolute;",tailShadowWidth:16,tailShadowHeight:10};if(FeBrowser.ie<=8&&FeBrowser.ie>0){e.tailShadowUrl=w.imgPath+"tail_noshadow.png"}e.simpleInfoWindowDomTemplate=T([\'<div class="{prefix}_pop" style="{popStyle}">\',\'<div class="{prefix}_center" style="{centerStyle}">\',\'<div class="{prefix}_content" style="{contentStyle}">\',"</div>","</div>",\'<div class="{prefix}_bottom" style="{bottomStyle}">\',\'<img src="{tailShadowUrl}" srcset="{tailShadowUrlSrcset}" style="{tailShadowStyle}">\',"</div>","</div>"],e);function je(jj,jh){for(var ji=0,jg=jj.length;ji<jg;++ji){if(jj[ji].className===e.prefix+"_"+jh){return jj[ji]}}}ev.extend(hi.prototype,{initialize:function(jh){var ji=this.map=jh.map;this.overlay=jh;this.render();this._bind();this.setContent();this.redraw(null,true);var jg=ji.simpleInfoWindowDoms;if(jg){if(jh.toString()==="Marker"){jg.marker=jh}else{jg.marker=null}}},render:function(){var jj=this.map;var ji=jj.simpleInfoWindowDoms;if(!ji){ji=jj.simpleInfoWindowDoms={};jj.simpleInfoWindow=jj.simpleInfoWindowDoms;var jh=e.simpleInfoWindowDomTemplate;bB(jj.platform,jh);if(jj.platform.lastChild.className===""){jj.platform.removeChild(jj.platform.lastChild)}ji.popDom=jj.platform.lastChild;var jg=ji.popDivs=ji.popDom.getElementsByTagName("DIV");ji.contentMain=je(jg,"content");ji.contentDiv=je(jg,"content");ji.centerDiv=je(jg,"center");ji.bottomDiv=je(jg,"bottom")}ji.hashCode=ji.popDom.hashCode=this.hashCode},_bind:function(){var ji=this;var jk=ji.map;var jj=jk.simpleInfoWindowDoms;var jg=jj.popDom;var jh=["mousedown","mouseout","mouseover","click","keydown","selectstart"];ev.each(jh,function(jl){ev.on(jg,jl,ad)});ev.on(jg,"dblclick",gH);ev.on(jg,"contextmenu",gH);if(window.addEventListener){jg.addEventListener("DOMMouseScroll",ad,false)}jg=jj=null},_setWinSize:function(ji,jg){var jh=this._config;ji=ji||jh.width;jg=jg||jh.height;if(jg<0){jg=0}this.pShowWidth=ji;this.pShowHeight=jg;this.setPosition()},setWidth:function(jg){jg=jg*1;if(!jg&&jg!==0||isNaN(jg)||jg<0){return}if(jg!==0){if(jg<50){jg=50}if(jg>730){jg=730}}this._config.width=jg;if(this._isMyDom()&&this.isOpen()){var jh=this;this.redraw(function(){jh.setPanToWithDelay()})}},setHeight:function(jg){jg=jg*1;if(!jg&&jg!==0||isNaN(jg)||jg<0){return}if(jg!==0){if(jg<50){jg=50}if(jg>650){jg=650}}this._config.height=jg;var ji=this.map;if(this._isMyDom()&&this.isOpen()){if(this._config.width!==0){ji.simpleInfoWindowDoms.contentDiv.style.width=this._config.width+"px"}var jh=this;this.redraw(function(){jh.setPanToWithDelay()})}},setContent:function(jh){jh=jh||this.content;var ji=this.map;this.content=jh;if(!this._isMyDom()){return}var jg=ji.simpleInfoWindowDoms.contentDiv;jg.innerHTML=jh;if(this._config.width!==0){jg.style.width=this._config.width+"px"}jg.style.display="block"},redraw:function(jn,jl){if(!this._isMyDom()){return}if(!jl&&!this.isOpen()){return}jn=jn||function(){};var ji=this;var jk=100;var jj=ji.map.simpleInfoWindow;var jp=jj.contentDiv.style;var jg=jj.contentMain.style;jp.width=jg.width="auto";jp.height=jg.height="auto";jp.whiteSpace="nowrap";if(jj.popDom.style.display==="none"){jj.popDom.style.visibility="hidden";this.show()}var jm=jj.contentMain.scrollWidth||0;jm=ji._config.width===0?jm:ji._config.width;jm=jm<50?50:jm;jm=jm>600?600:jm;jg.width=jm+"px";var jh;jh=jj.contentMain.scrollHeight||0;jh=ji._config.height===0?jh:ji._config.height;ji._setWinSize(jm,jh);if(this.isOpen()){jo()}else{setTimeout(jo,jk)}function jo(){jp.whiteSpace="";jg.overflowX=(ji._config.width===0)?"hidden":"auto";jg.overflowY=(ji._config.height===0)?"hidden":"auto";jh=jj.contentMain.scrollHeight||0;jh=ji._config.height===0?jh:ji._config.height;jh=jh<50?50:jh;jh=jh>440?440:jh;ji._setWinSize(jm,jh);jj.popDom.style.visibility="";jg.height=jh+"px";jj.centerDiv.style.height=jh+"px";jj.bottomDiv.style.width=jm+"px";jj.centerDiv.style.width=jm+"px";jj.popDom.style.width=jm+"px";ji.dispatchEvent(new fa("onresize"));ji.setPanToWithDelay();jn()}},setPosition:function(jk,jl){if(!this._isMyDom()){return}var jg=this.map.simpleInfoWindowDoms;var jh=this.overlay;var jj=this.map.pointToOverlayPixelIn(jh.getPoint(),{zoom:jl,center:jk});var ji=jh.getIcon();if(jj.onBack||jj.outOfFrustum){ev.hide(jg.popDom);return}if(this._visible===true){ev.show(jg.popDom)}var jm=new eO(jj.x-ji.offset.width+ji.infoWindowOffset.width+jh.getOffset().width+this._config.offset.width,jj.y-ji.offset.height+ji.infoWindowOffset.height+jh.getOffset().height+this._config.offset.height);jg.popDom.style.left=-this.pShowWidth/2+jm.x+e.windowOffset[0]+"px";jg.popDom.style.top=-this.pShowHeight+jm.y-e.tailShadowHeight+e.windowOffset[1]+"px";jg.bottomDiv.style.left=this.pShowWidth/2-e.tailShadowWidth/2+"px"},setPanToWithDelay:function(jg){var jh=this;setTimeout(function(){jh.setPanTo()},jg||200)},setPanTo:function(){if(!this.overlay||!this.overlay.getPoint()||!this._config.enableAutoPan||!this._isMyDom()){return}var jx=this.map;var jo=jx.simpleInfoWindowDoms;var ji=jo.popDivs;var jy=jo.popDom;if(!ji||!jy){return}var jq;var jj=parseInt(je(ji,"content").style.width,10)+2;var ju=parseInt(ev.Dom.getComputedStyle(je(ji,"center"),"height"))+parseInt(ev.Dom.getComputedStyle(je(ji,"bottom"),"height"));var js=parseFloat(jy.style.left,10);var jl=parseFloat(jy.style.top,10);if(this.map._renderType==="webgl"){js+=parseInt(this.map.platform.style.left,10);jl+=parseInt(this.map.platform.style.top,10)}else{js+=this.map.offsetX;jl+=this.map.offsetY}var jn=new eO(js,jl);var jm=new eO(jj+js,ju+jl);var jv,jt;if(this._config.height!==0&&document.all){if(!jx.temp.infoKey){jx.temp.infoKey=-1}jv=-jx.temp.infoKey;jx.temp.infoKey=-jx.temp.infoKey}jv=0;jt=0;var jg=10;var jh=this._config.margin[0];var jk=this._config.margin[1];var jw=this._config.margin[2];var jp=this._config.margin[3];if(jn.x<jp){jv=-jn.x+jp}if(jn.y<jh){jt=-jn.y+jh}if(jm.x>jx.width-jk){jv=jx.width-jm.x-jk}if(jm.y>jx.height-jw){jt=jx.height-jm.y-jw}this._loadCollisions();var jr=this._config.collisions;if(jn.x<jr[0][0]&&jn.y<jr[0][1]){if(Math.abs(-jn.x+jr[0][0])<Math.abs(-jn.y+jr[0][1])){jv=-jn.x+jr[0][0]}else{if(jx.height-jr[0][1]-jr[3][1]<ju){jv=-jn.x+jr[0][0]}else{jt=-jn.y+jr[0][1]}}if(jx.width-jr[0][0]-jr[1][0]<jj&&jn.y<jr[1][1]){jt=-jn.y+jr[1][1]}}if(jm.x>jx.width-jr[1][0]&&jn.y<jr[1][1]){if(Math.abs(-jm.x+jx.width-jr[1][0])<Math.abs(-jn.y+jr[1][1])&&jx.width-jr[0][0]-jr[1][0]>=jj){jv=-jm.x+jx.width-jr[1][0]}else{jt=-jn.y+jr[1][1];if(jx.width-jr[0][0]-jr[1][0]<jj&&jx.width-jr[0][0]<jj){jv=-jn.x+jr[0][0]}}}if(jn.x<jr[3][0]&&jm.y>jx.height-jr[3][1]){if(Math.abs(-jn.x+jr[3][0])<Math.abs(-jm.y+jx.height-jr[3][1])&&(Math.abs(-jn.x+jr[3][0])<Math.abs(jt)&&jt!==0||jt===0)&&jx.width-jr[3][0]>=jj){jv=-jn.x+jr[3][0]}else{jt=-jm.y+jx.height-jr[3][1]}if(jx.height-jr[0][1]-jr[3][1]<ju&&jn.x<jr[0][0]){jv=-jn.x+jr[0][0]}}if(jm.x>jx.width-jr[2][0]&&jm.y>jx.height-jr[2][1]){if(Math.abs(-jm.x+jx.width-jr[2][0])<Math.abs(-jm.y+jx.height-jr[2][1])&&(Math.abs(-jm.x+jx.width-jr[2][0])<Math.abs(jt)&&jt!==0||jt===0)&&jx.width-jr[0][0]-jr[1][0]>=jj){jv=-jm.x+jx.width-jr[2][0]}else{if(jx.height-jr[1][1]-jr[2][1]>=ju){jt=-jm.y+jx.height-jr[2][1]}else{jt=-jn.y+jr[1][1]}if(jx.width-jr[0][0]-jr[2][0]<jj){jv=-jn.x+jr[0][0]}}}if(jv!==0||jt!==0){jx.panBy(jv,jt,{point:this.getPoint()})}},_loadCollisions:function(){if(!this.map){return}var jh=this.map;this._config.collisions=[[10,10],[10,10],[10,10],[10,10]];var jq=this.map.container;for(var jo=0,ji=jq.children.length;jo<ji;jo++){var jl,jr,ju=!!(typeof jq.children[jo]._anchor!="undefined"&&jq.children[jo]._offset);if(jq.children[jo]._jsobj&&jq.children[jo]._jsobj instanceof f5&&jq.children[jo]._jsobj.blockInfoWindow===true){jl=jq.children[jo]}else{if(ju){jl=jq.children[jo]}else{continue}}var js=jl.offsetWidth,jp=jl.offsetHeight,jg=jl._jsobj,jk,jn;if(!jg||ju){if(typeof jl._anchor!="undefined"&&jl._offset&&b1(jl).display!="none"&&b1(jl).visibility!="hidden"){jk=jl._offset;jn=jl._anchor}else{continue}}else{if(jg.isVisible()===false){continue}jk=jg.getOffset();jn=jg.getAnchor()}switch(jn){case BMAP_ANCHOR_TOP_LEFT:jr=0;break;case BMAP_ANCHOR_TOP_RIGHT:jr=1;break;case BMAP_ANCHOR_BOTTOM_LEFT:jr=3;break;case BMAP_ANCHOR_BOTTOM_RIGHT:jr=2;break;default:break}var jm=js+jk.width+10,jj=jp+jk.height+10,jt=this._config.collisions[jr];this._config.collisions[jr]=[jm>jt[0]?jm:jt[0],jj>jt[1]?jj:jt[1]]}},show:function(){this._visible=true;if(!this._isMyDom()){return}var jh=this.map.simpleInfoWindowDoms;if(jh.popDom.style.display!="none"){return}ev.show(jh.popDom);var jg=new fa("onopen");jg.point=this.getPoint();this.dispatchEvent(jg);this.redraw()},hide:function(){this._visible=false;if(!this._isMyDom()){return false}var jh=this.map.simpleInfoWindowDoms;if(jh.popDom.style.display=="none"){return false}if(this._config.onClosing()===false){return false}ev.hide(jh.popDom);var jg=new fa("onclose");jg.point=this.getPoint();this.dispatchEvent(jg);this.map.removeEventListener("click",this.map.temp._clickCloseHandler);this.map.temp._clickCloseBinded=false;this.decontrol();return true},isOpen:function(){if(!this.map){return false}var jg=this.map.temp.infoWin;if(!jg){return false}if(!this._isMyDom()){return false}if(jg&&jg.overlay===this.overlay&&this.map.simpleInfoWindowDoms&&this.map.simpleInfoWindowDoms.popDom.style.display=="none"){return false}else{return true}},_revert:function(){if(!this._isMyDom()){return}var jg=this.map.simpleInfoWindowDoms;jg.contentDiv.innerHTML="";jg.maxContentDiv.innerHTML=""},_setOverflow:function(){var ji=this.map;if(!this._isMyDom()){return}var jh=ji.simpleInfoWindowDoms,jg=jh.contentMain.style;jh._overflowX=jg.overflowX;jh._overflowY=jg.overflowY;jg.overflowX="hidden";jg.overflowY="hidden"},_resetOverflow:function(){var ji=this.map;if(!this._isMyDom()||!ji.simpleInfoWindowDoms._overflowX||!ji.simpleInfoWindowDoms._overflowY){return}var jh=ji.simpleInfoWindowDoms,jg=jh.contentMain.style;jg.overflowX=jh._overflowX;jg.overflowY=jh._overflowY;delete jh._overflowX;delete jh._overflowY},_draw:function(){if(this._visible===true&&this.overlay){this.overlay.openSimpleInfoWindow(this)}},_isMyDom:function(){return(this.map&&this.map.simpleInfoWindowDoms&&this.map.simpleInfoWindowDoms.hashCode==this.hashCode)}});d9.prototype.openSimpleInfoWindow=function(jj){if(this.map&&this.map.temp&&this.map.temp.infoWin instanceof i.InfoWindow){this.map.closeInfoWindow()}var ji=this.map;if(!jj||!this.map||!this.domElement||this.isVisible()===false||jj.toString()!=="SimpleInfoWindow"){return}var jh=ji.temp;if(jh.infoWin&&jh.infoWin.overlay&&jh.infoWin.overlay._fromMap){ji.closeSimpleInfoWindow()}if(jh.infoWin===jj&&jh.infoWin.isOpen()&&jh.infoWin.overlay===this){jj.setPanToWithDelay();return}ji.closeSimpleInfoWindow();this.simpleInfoWindow=jj;if(jh.infoWin===null||jh.infoWin!==jj){jh.infoWin=jj;jj.initialize(this)}else{jj.redraw(null,true)}ev.BaseClass.call(jj,jj.hashCode);if(!jh._clickCloseHandler){jh._clickCloseHandler=function(jk){if(jk.overlay||(jk.spots&&jk.spots.length>0)){return}if(ji.temp.infoWin&&ji.temp.infoWin._config.enableCloseOnClick){ji.closeSimpleInfoWindow();ji.removeEventListener("spotclick",jh._clickCloseHandler);jh._clickCloseBinded=false}}}if(!jh._clickCloseBinded){setTimeout(function(){ji.addEventListener("spotclick",jh._clickCloseHandler);jh._clickCloseBinded=true},200)}if(jh._infoWin){delete jh._infoWin}jj.overlay=this;var jg=ji.simpleInfoWindowDoms;this.map.getPanes().floatPane.appendChild(jg.popDom);jj.setPanToWithDelay();this.dispatchEvent(new fa("oninfowindowopen"))};d9.prototype.closeSimpleInfoWindow=function(){if(!this.map||!this.map.simpleInfoWindowDoms){return}var jh=this;if(jh.simpleInfoWindow&&jh.simpleInfoWindow.hashCode===jh.map.simpleInfoWindowDoms.hashCode){try{if(jh.simpleInfoWindow.hide()===true){jh.dispatchEvent(new fa("oninfowindowclose"));jh.map.temp.infoWin=jh.simpleInfoWindow=null}}catch(jg){}}}})(BMapGL);');
